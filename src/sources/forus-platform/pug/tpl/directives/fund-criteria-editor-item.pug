.criterion-item
    .criterion-section
        .criterion-title(
            ng-class="{'criterion-title-large' : !$dir.criterion.is_editing && $dir.criterion.validators.length == 0}"
            ng-bind="$dir.criterion.title")
        .criterion-actions
            .button.button-default(
                ng-if="!$dir.criterion.is_editing"
                ng-click="$dir.criterionEdit($dir.criterion)")
                em.mdi.mdi-pencil.icon-start
                | Edit

            .button.button-default(
                ng-if="$dir.criterion.is_editing"
                ng-click="$dir.cancelCriterion()")
                em.mdi.mdi-close.icon-start
                | Cancel
    
        .criterion-organizations-list(ng-if="!$dir.criterion.is_editing")
            .row(ng-if="$dir.criterion.validators_models.length > 0"): .col.col-lg-12: label.form-label Validator organisations
            .criterion-organization(ng-repeat="validator in $dir.criterion.validators_models").active
                .criterion-organization-icon: .mdi.mdi-shield-check
                .criterion-organization-name(ng-bind="validator.name")

        .flex-row(ng-if="$dir.criterion.is_editing")
            .flex-col.flex-col-2.form-group
                label.form-label Eigenschap
                select(
                    ng-model="$dir.criterion.record_type_key" 
                    ng-options="operator.key as operator.name for operator in $dir.recordTypes").form-control
                .form-error(ng-repeat="error in $dir.errors.record_type_key" ng-bind="error")
            
            .flex-col.flex-col-2.form-group
                label.form-label Verhouding
                select(
                    ng-model="$dir.criterion.operator" 
                    ng-options="operator.key as operator.name for operator in $dir.operators").form-control
                .form-error(ng-repeat="error in $dir.errors.operator" ng-bind="error")
            
            .flex-col.flex-col-2.form-group
                label.form-label Waarde
                input(type="text" ng-model="$dir.criterion.value").form-control
                .form-error(ng-repeat="error in $dir.errors.value" ng-bind="error")
            
            .flex-col.form-group
                label.form-label &nbsp;
                
                .button.button-primary.button-icon.pull-left(
                    ng-click="$dir.editDescription($dir.criterion)"
                    ): em.mdi.mdi-comment-text.icon-start
                
                .button.button-default.button-icon.pull-left(
                    ng-click="$dir.removeCriterion()"
                    ): em.mdi.mdi-close.icon-start

        .flex-row(ng-if="$dir.criterion.is_editing")
            .flex-col.flex-col-2.form-group
                label(for='criterion_{{ $dir.criterion.id }}').checkbox.checkbox-narrow
                    input(type="checkbox" ng-model="$dir.criterion.show_attachment" id='criterion_{{ $dir.criterion.id }}')
                    .checkbox-label 
                        .checkbox-box: .mdi.mdi-check
                        | Bijlage uploaden
    

    .criterion-section(ng-if="$dir.criterion.is_editing && ($dir.criterion.show_external_validators_form || $dir.criterion.validators.length > 0)")
        .criterion-organizations-root
            .criterion-subtitle External validators
            .flex-row(ng-if="$dir.criterion.validators.length > 0")
                .flex-col: .criterion-organizations(ng-if="$dir.criterion.validators_list[0].length > 0")
                    .criterion-organization(ng-repeat="validator in $dir.criterion.validators_list[0]")
                        .criterion-organization-icon: .mdi.mdi-shield-check-outline
                        .criterion-organization-name(ng-bind="validator.name")
                        .criterion-organization-actions(
                            ng-click="$dir.removeExternalValidator($dir.criterion, validator.id)"
                            ): .mdi.mdi-close
                
                .flex-col: .criterion-organizations(ng-if="$dir.criterion.validators_list[1].length > 0")
                    .criterion-organization(ng-repeat="validator in $dir.criterion.validators_list[1]")
                        .criterion-organization-icon: .mdi.mdi-shield-check-outline
                        .criterion-organization-name(ng-bind="validator.name")
                        .criterion-organization-actions(
                            ng-click="$dir.removeExternalValidator($dir.criterion, validator.id)"
                            ): .mdi.mdi-close

        div(ng-if="$dir.criterion.show_external_validators_form")
            .flex-row
                .flex-col: .flex-row
                    .flex-col.flex-grow
                        .form-group
                            label.form-label Select organization
                            select(
                                ng-options="validator.id as validator.name for validator in $dir.criterion.validators_available"
                                ng-model="$dir.criterion.new_validator").form-control
                    .flex-col: .form-group
                        label.form-label &nbsp;
                        .button.button-primary(
                            ng-class="{'button-disabled' : !$dir.criterion.new_validator}"
                            ng-click="$dir.addExternalValidator($dir.criterion)") Add
                .flex-col
            
        //- div(ng-if="$dir.criterion.validators.length > 0 && $dir.criterion.show_external_validators_form")
            .flex-row: .criterion-subtitle
            .flex-row: .criterion-subtitle
    

    .criterion-section(ng-if="$dir.criterion.is_editing")
        .button.button-primary(
            ng-if="!$dir.criterion.show_external_validators_form"
            ng-click="$dir.criterion.show_external_validators_form = true")
            em.mdi.mdi-plus-circle.icon-start
            | Add external validator
        
        .button.button-primary.pull-right(ng-click="$dir.saveCriterion($dir.criterion)")
            em.mdi.mdi-content-save.icon-start
            | Bevestig
        
    //- .criterion-section
        .button.button-default
            em.mdi.mdi-close.icon-start
            | Cancel
        
        .button.button-primary.pull-right
            em.mdi.mdi-content-save.icon-start
            | Bevestig